(()=>{var e={n:o=>{var t=o&&o.__esModule?()=>o.default:()=>o;return e.d(t,{a:t}),t},d:(o,t)=>{for(var r in t)e.o(t,r)&&!e.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:t[r]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};(()=>{"use strict";e.r(o);const t=flarum.core.compat["common/app"];e.n(t)().initializers.add("dhtml/persona",(function(){}));const r=flarum.core.compat["forum/app"];var n=e.n(r);const a=flarum.core.compat["common/extend"],u=flarum.core.compat["common/components/Button"];var i=e.n(u);const c=flarum.core.compat["common/components/HeaderSecondary"];var s=e.n(c);const l=flarum.core.compat["common/components/SelectDropdown"];var d=e.n(l);function p(){(0,a.extend)(s().prototype,"items",(function(e){var o=n().session.user,t=!1,r="";o&&(r=o.email(),t=o.groups().some((function(e){var o=e.data.id;return"1"===o||"4"===o})));var a=function(e,o){return Object.values(o).some((function(o){return o&&e.includes(o)}))}(r,{pattern1:n().forum.attribute("domainpattern1"),pattern2:n().forum.attribute("domainpattern2"),pattern3:n().forum.attribute("domainpattern3")});if(t||a){var u=JSON.parse(n().forum.attribute("dhtmlPersonaUsers"));u.unshift("Add New User");for(var c=[],s=function(){var e=u[l];c.push(m(i(),{icon:"fas fa-user",onclick:function(){var o;"Add New User"==(o=e)?function(){var e=prompt("Enter username","");n().request({method:"POST",url:n().forum.attribute("baseUrl")+"/api/persona-register",body:{username:e}}).then((function(e){window.location.reload()})).catch((function(e){console.log(e),console.error("Register failed")}))}():n().request({method:"POST",url:n().forum.attribute("baseUrl")+"/api/persona-login",body:{username:o}}).then((function(e){window.location.reload()})).catch((function(e){console.error("Login failed",e),alert("Login failed")}))}},e))},l=0;l<u.length;l++)s();var p=n().translator.trans("dhtml-persona.forum.persona");e.add("persona",m(d(),{buttonClassName:"Button Button--link",accessibleToggleLabel:p},c),21)}}))}n().initializers.add("dhtml/persona",(function(){p()}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map